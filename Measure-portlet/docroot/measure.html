<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Measure</title>
		<script type="text/javascript" src='js/jquery-1.6.2.min.js'></script>
		<script src='http://dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.1'></script>
		<script type='text/javascript' src='js/OpenLayers.js'></script>
		<script type="text/javascript" src="js/chm/CHM.js"></script>
		<script type="text/javascript" src="js/chm/CHMMap.js"></script>
		<script type="text/javascript" src="js/chm/Point.js"></script>
		<script type="text/javascript" src="js/chm/Measure.js"></script>
		<script type="text/javascript" src="js/chm/MeasureControl.js"></script>
		<script type="text/javascript" src="js/chm/MeasureCHMMap.js"></script>
	</head>
	<body>
		<div id='map_element' style='width: 500px; height: 500px;'></div>
		<form name='form' id='form'>
			<input name='lat' id='lat'/>
			<input name='lon' id='lon'/>
			<input name='area' id='area'/>
		</form>
		<a onclick="handleClick(event)">Test setMeasure()</a>
		<script>
			var proxyUrl = '';
			
			var geoserverUrl = 'http://localhost/geoserver/';
			
			var wms = 'wms';
			
			var wfs = 'wfs';
			
			var measurechmmap;
			
		    $(document).ready(function() {
		    	setTimeout(function(){init();}, 500);
		    });
		    
		    function init() {	
		    	measurechmmap = new CHM.MeasureCHMMap('map_element', {});
		    	
		    	measurechmmap.setOnMeasureChanged(this.measureChanged);
				
		    	measurechmmap.setOnAreaChanged(this.areaChanged);
		    	
		    	handleClick(null);
		    }    			
		
		    function handleClick(e) {
				measurechmmap.setMeasure(new CHM.Measure(document.form.lat.value, document.form.lon.value, new OpenLayers.Projection('EPSG:4326')));
			}
					
			function measureChanged() {
				var measure = measurechmmap.getMeasure(new OpenLayers.Projection('EPSG:4326'));
						
				document.form.lat.value = measure.x;
						
				document.form.lon.value = measure.y;
			}
					
			function areaChanged() {
				document.form.area.value = measurechmmap.getArea();
			}
		</script>
	</body>
</html>
