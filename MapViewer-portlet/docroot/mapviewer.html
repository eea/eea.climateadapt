<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>Prototype MapViewer</title>
		<script type='text/javascript' src="http://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=6.2&amp;mkt=en-us"></script>
		<script type="text/javascript" src='js/ext-base.js'></script>
		<script type="text/javascript" src='js/ext-all.js'></script>
		<script type="text/javascript" src='js/jquery.min.js'></script>
		<script type='text/javascript' src='js/OpenLayers.js'></script>
		<script type="text/javascript" src='js/GeoExt.js'></script>
		<script type="text/javascript" src="js/chm/CHM.js"></script>
		<script type="text/javascript" src="js/chm/CHMMap.js"></script>
		<script type="text/javascript" src="js/chm/MapViewerCHMMap.js"></script>
		<script type="text/javascript" src="js/chm/MapState.js"></script>
		<script type="text/javascript" src="js/chm/CSW.js"></script>
		<script type="text/javascript" src="js/chm/Resource.js"></script>
		<script type="text/javascript" src="js/chm/ResourceSet.js"></script>
		<script type="text/javascript" src="js/chm/Point.js"></script>
		<script type="text/javascript" src="js/chm/Locator.js"></script>
		<script type="text/javascript" src="js/chm/Location.js"></script>
		<script type="text/javascript" src="js/chm/LocationControl.js"></script>
	</head>
	<body>

		<div id="getRecordByID">
			<input type="text" name="recordID" id="recordID" value="66dc6023-fece-4044-ab8b-49ac6379da35" />
			<input type="submit" value="GetRecordByID" onclick="getRecordByID(document.getElementById('recordID').value)"/>
		</div>

		<div id='status_element'>Status</div>

		<div id='map_element'></div>

		<div id='legend_element'></div>

		<script>
			var proxyUrl = '';
			
			var geoserverUrl = 'http://localhost/geoserver/';
			
			var wfs = 'wfs';
			
			var wms = 'wms';
	
			var locatorUrl = 'http://localhost/ve/REST/v1/Locations/';
			
			var locatorKey = 'Ao9qujBzDtg-nFiusTjt5VQ9x2NJB2wAD7YCRjaPz7hQQjxdFcl24tyhOwCDCIrw';
			
			var zoomLevel = '2';

			var cswServletUrl = 'http://localhost/cswservlet?';
			
			var cswUrl = 'http://dev.ace.geocat.net/geonetwork/srv/en/csw?';

			var mapViewerServletUrl = 'http://localhost/mapviewerservlet';
			
			var map;
						
			var locator;
			
			var csw;
			
		    Ext.onReady(function() {
				map = new CHM.MapViewerCHMMap();
				
				map.setOnStatusChanged(handleStatusChanged);
				
				map.setOnRestoreComplete(handleRestoreComplete);
				
		        mapPanel = new GeoExt.MapPanel({
		            renderTo: 'map_element',
					height: 350,
					width: 675,
		            map: map
		        });
		        
		        legendPanel = new GeoExt.LegendPanel({
		            layerStore: mapPanel.layers,
		            renderTo: "legend_element",
		            border: false
		        });
		        
 		        map.addBingLayers();
 		        
 		        map.restore();
		    });
		    
		    function handleStatusChanged() {
		    	document.getElementById('status_element').innerHTML = map.getStatus();
			}
		    
		    function handleRestoreComplete() {
 		        map.registerEvents();
 		        
				test_layer = new OpenLayers.Layer.WMS('Test', 
						geoserverUrl + wms + '?', 
						{layers: 'nuts:nuts3', format: 'image/png', transparent: 'true'}, 
						{visibility: true}, 
						{tileOptions: {maxGetUrlLength: 2048}}, 
						{isBaseLayer: false}
					);
				
				map.addLayer(test_layer);
			}
		</script>
	</body>
</html>
